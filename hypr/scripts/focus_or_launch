#!/usr/bin/env nu

def --wrapped main [focus: string, ...launch] {
    let choices = hyprctl clients -j | from json | where ($it.class == $focus)
    let len = $choices | length

    if $len > 1 {
        let selected_title = $choices 
        | get title 
        | to text 
        | rofi -case-smart -dmenu -p $focus -i -window-title "rofi"

        let focused = hyprctl dispatch focuswindow $"title:($selected_title)"

        if $focused == "ok" {
            return;
        }

        exec ...$launch
    } else {
        let focused = hyprctl dispatch focuswindow $"class:($focus)"

        if $focused == "ok" {
            return;
        }

        exec ...$launch
    }
}
